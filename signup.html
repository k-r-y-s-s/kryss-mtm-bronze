<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up - My Tenant Manager</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>
    <div class="auth-container">
        <div class="auth-box">
            <div class="auth-header">
                <h2>üè† My Tenant Manager</h2>
                <p>Start Your 7-Day Free Trial</p>
            </div>
            
            <form id="signupForm">
                <div class="form-group">
                    <label for="email">Email Address</label>
                    <input type="email" id="email" required placeholder="landlord@example.com" autocomplete="email">
                </div>
                
                <div class="form-group">
                    <label for="password">Password (min. 6 characters)</label>
                    <input type="password" id="password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="new-password" minlength="6">
                </div>
                
                <div class="form-group">
                    <label for="confirmPassword">Confirm Password</label>
                    <input type="password" id="confirmPassword" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="new-password" minlength="6">
                </div>
                
                <button type="submit" class="btn btn-primary btn-block">
                    Start 7-Day Free Trial
                </button>
                
                <p class="terms">By signing up, you agree to our Terms of Service</p>
            </form>
            
            <div class="auth-links">
                <p>Already have an account? <a href="login.html">Login here</a></p>
                <p><a href="index.html">‚Üê Back to Home</a></p>
            </div>
        </div>
    </div>
    
    <script>
        // Supabase credentials
        const supabaseUrl = 'https://hnjlrjtiomdqcqznkuxh.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhuamxyanRpb21kcWNxem5rdXhoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk4NDQ5MTUsImV4cCI6MjA4NTQyMDkxNX0.iW9E91LYLNSkpjiITNcXa7Zj1rpcw8euriHkgfQ19dQ';
        
        // Initialize Supabase
        const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);
        
        // Handle signup
        document.getElementById('signupForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            // Validation
            if (password !== confirmPassword) {
                alert("‚ùå Passwords do not match!");
                return;
            }
            
            if (password.length < 6) {
                alert("‚ùå Password must be at least 6 characters!");
                return;
            }
            
            try {
                const { data, error } = await supabaseClient.auth.signUp({
                    email: email.trim(),
                    password: password
                });
                
                if (error) {
                    alert("Signup error: " + error.message);
                    return;
                }
                
                // Signup successful
                alert("‚úÖ Account created successfully!\n\nYou can now login with your credentials.");
                
                // Redirect to login page
                window.location.href = 'login.html';
                
            } catch (error) {
                alert("Signup failed: " + error.message);
            }
        });
    </script>
</body>
</html>                
                <div class="form-group">
                    <label for="confirmPassword">Confirm Password</label>
                    <input type="password" id="confirmPassword" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                
                <div class="form-group">
                    <label for="fullName">Full Name (Optional)</label>
                    <input type="text" id="fullName" placeholder="Juan Dela Cruz">
                </div>
                
                <div style="margin: 1.5rem 0; padding: 1rem; background: #f3f4f6; border-radius: 0.375rem;">
                    <label style="display: flex; align-items: start; gap: 0.5rem;">
                        <input type="checkbox" id="terms" required style="margin-top: 0.25rem;">
                        <div>
                            <strong>I agree to the Terms of Service</strong>
                            <p class="small-text" style="margin-top: 0.25rem;">
                                By signing up, you confirm you have the right to use this service for rental management purposes.
                            </p>
                        </div>
                    </label>
                </div>
                
                <button type="submit" class="btn btn-primary btn-block">
                    Start Free Trial - ‚Ç±0 for 7 Days
                </button>
            </form>
            
            <div class="auth-links">
                <p>Already have an account? <a href="login.html">Login here</a></p>
                <p><a href="index.html">‚Üê Back to Home</a></p>
            </div>
        </div>
    </div>
    
    <script>
        // Initialize Supabase
        const supabaseUrl = 'https://hnjlrjtiomdqcqznkuxh.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhuamxyanRpb21kcWNxem5rdXhoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk4NDQ5MTUsImV4cCI6MjA4NTQyMDkxNX0.iW9E91LYLNSkpjiITNcXa7Zj1rpcw8euriHkgfQ19dQ';
        const supabase = supabaseClient.createClient(supabaseUrl, supabaseKey);
        
        // Handle signup
        document.getElementById('signupForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const fullName = document.getElementById('fullName').value;
            
            // Validation
            if (password !== confirmPassword) {
                alert('Error: Passwords do not match!');
                return;
            }
            
            if (password.length < 6) {
                alert('Error: Password must be at least 6 characters!');
                return;
            }
            
            document.getElementById('loadingScreen').classList.remove('hidden');
            
            try {
                // 1. Create auth user
                const { data: authData, error: authError } = await supabase.auth.signUp({
                    email: email,
                    password: password
                });
                
                if (authError) throw authError;
                
                // 2. Create profile with 7-day trial
                if (authData.user) {
                    const trialEndsAt = new Date();
                    trialEndsAt.setDate(trialEndsAt.getDate() + 7); // 7-day trial
                    
                    const { error: profileError } = await supabase
                        .from('profiles')
                        .insert([{ 
                            id: authData.user.id, 
                            email: email,
                            full_name: fullName || null,
                            subscription_tier: 'bronze',
                            trial_ends_at: trialEndsAt.toISOString()
                        }]);
                    
                    if (profileError) throw profileError;
                }
                
                // 3. Show success and redirect
                alert('Account created successfully! Your 7-day free trial has started.');
                setTimeout(() => {
                    window.location.href = 'login.html';
                }, 1000);
                
            } catch (error) {
                document.getElementById('loadingScreen').classList.add('hidden');
                alert('Signup failed: ' + error.message);
            }
        });
    </script>
</body>
</html>
